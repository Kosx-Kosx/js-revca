COFFEE = coffee
COFFEE_FLAGS = -m -b

scripts/bundle.js: everything
	browserify scripts/application.js -o scripts/bundle.js

all: compile

test:
	mocha tests/test*.coffee --compilers coffee:coffee-script

compile: everything

clean:
	rm $(ALL_OUTPUTS)

scripts/minified.js: scripts/bundle.js
	closure scripts/bundle.js --compilation_level SIMPLE_OPTIMIZATIONS > scripts/minified.js

.must-be-master:
	git checkout master

publish: .must-be-master test all
	sh deploy.sh
