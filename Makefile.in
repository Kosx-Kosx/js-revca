COFFEE = coffee
COFFEE_FLAGS = -m -b

bundle.js: everything
	browserify scripts/application.js -o bundle.js

all: compile

test:
	mocha tests/test*.coffee --compilers coffee:coffee-script

compile: everything

clean:
	rm $(ALL_OUTPUTS)

minified.js: bundle.js
	closure bundle.js --compilation_level SIMPLE_OPTIMIZATIONS > minified.js

.must-be-master:
	git checkout master

publish: .must-be-master test all
	sh deploy.sh
